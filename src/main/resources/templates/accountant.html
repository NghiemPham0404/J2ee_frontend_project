<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Kế toán</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .table th, .table td {
            text-align: center;
        }
        .active-btn {
          background: linear-gradient(195deg, #c2e59c 0%, #64b3f4 100%);
          color: white;
          border: none;
        }
        .input-group {
          margin-bottom: 15px;
        }
        .form-label {
          font-weight: bold;
        }
        .table tbody tr:hover {
          background: linear-gradient(195deg, #c2e59c, #64b3f4);
          cursor: pointer;
          color: white;
        }
    </style>
</head>
<body>
<div th:replace="~{header :: navbar}"></div>

<div class="container mt-5">
    <h1 class="text-center">Kế Toán</h1>

    <div class="row mb-2 mt-4">
        <div class="col-md-10 offset-md-1">
            <div class="input-group mb-3">
                <input class="form-control" id="searchInput" onkeyup="filterColumn()" placeholder="Tìm kiếm dự án..."
                       type="text"/>
                <button class="btn btn-primary" onclick="searchProjects()">Tìm kiếm</button>
            </div>
        </div>
    </div>

    <button class="btn btn-outline-primary mb-3 active-btn" id="approvedProjectsBtn" onclick="showApprovedProjects()">Dự
        án đang vận động
    </button>
    <button class="btn btn-outline-primary mb-3" id="pendingProjectsBtn" onclick="showPendingProjects()">Dự án đã kết
        thúc
    </button>
    <button class="btn btn-outline-primary mb-3" id="undisbursedProjectsBtn" onclick="showUndisbursedProjects()">Dự án
        chưa giải ngân
    </button>


    <div id="projectsTableContainer">
        <table class="table table-bordered" id="approvedProjectsTable">
            <thead>
            <tr>
                <th>ID</th>
                <th>Tên Dự án</th>
                <th>Mô tả</th>
                <th>Ngày Bắt đầu</th>
                <th>Ngày Kết thúc</th>
                <th>Mục tiêu</th>
                <th>Hiện có</th>
                <th>Trạng thái</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="charity : ${data}"
                th:onclick="window.location.href='/charity-events/' + /*[[${charity.id}]]*/ ''">
                <td th:text="${charity.id}"></td>
                <td th:text="${charity.name}"></td>
                <td th:text="${charity.description}"></td>
                <td th:text="${charity.startTime}"></td>
                <td th:text="${charity.endTime}"></td>
                <td th:text="${charity.goalAmount}"></td>
                <td th:text="${charity.currentAmount}"></td>
                <td>
                    <span th:classappend="${charity.disbursed} ? 'text-danger fw-bold' : 'text-success fw-bold'"
                          th:text="${charity.disbursed ? 'Đã giải ngân' : 'Đang hoạt động'}">
                    </span>
                </td>
            </tr>
            </tbody>
        </table>

        <!-- Bảng dự án đã kết thúc -->
        <table class="table table-bordered" id="pendingProjectsTable" style="display: none;">
            <thead>
            <tr>
                <th>ID</th>
                <th>Tên Dự án</th>
                <th>Ngày Bắt đầu</th>
                <th>Ngày Kết thúc</th>
                <th>Mục tiêu</th>
                <th>Hoàn thành</th>
            </tr>
            </thead>
            <tbody>
            <!-- Lặp qua các dự án có trạng thái đã giải ngân -->
            <tr th:each="charity : ${data}" th:if="${charity.disbursed}"
                th:onclick="window.location.href='/charity-events/' + /*[[${charity.id}]]*/ ''">
                <td th:text="${charity.id}"></td>
                <td th:text="${charity.name}"></td>
                <td th:text="${charity.startTime}"></td>
                <td th:text="${charity.endTime}"></td>
                <td th:text="${charity.goalAmount}"></td>
                <td th:text="${charity.currentAmount}"></td>
                <td>
                    <span th:classappend="${charity.disbursed} ? 'text-danger fw-bold' : 'text-success fw-bold'"
                          th:text="${charity.disbursed ? 'Đã giải ngân' : 'Đang hoạt động'}">
                    </span>
                </td>
            </tr>
            </tbody>
        </table>

        <table class="table table-bordered" id="undisbursedProjectsTable" style="display: none;">
            <thead>
            <tr>
                <th>ID</th>
                <th>Tên Dự án</th>
                <th>Ngày Bắt đầu</th>
                <th>Ngày Kết thúc</th>
                <th>Mục tiêu</th>
                <th>Hiện có</th>
                <th>Hành động</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="charity : ${data}" th:if="${!charity.disbursed}"
                th:onclick="window.location.href='/charity-events/' + /*[[${charity.id}]]*/ ''">
                <td th:text="${charity.id}"></td>
                <td th:text="${charity.name}"></td>
                <td th:text="${charity.startTime}"></td>
                <td th:text="${charity.endTime}"></td>
                <td th:text="${charity.goalAmount}"></td>
                <td th:text="${charity.currentAmount}"></td>
                <td>
                    <span th:classappend="${charity.disbursed} ? 'text-danger fw-bold' : 'text-success fw-bold'"
                          th:text="${charity.disbursed ? 'Đã giải ngân' : 'Đang hoạt động'}">
                    </span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    <!--    function showProjectDetails(id, name, description, startDate, endDate, target, currentAmount) {-->
    <!--      document.getElementById('projectId').value = id;-->
    <!--      document.getElementById('projectName').value = name;-->
    <!--      document.getElementById('projectDescription').value = description;-->
    <!--      document.getElementById('projectStartDate').value = startDate;0-->
    <!--      document.getElementById('projectEndDate').value = endDate;-->
    <!--      document.getElementById('projectTarget').value = target;-->
    <!--      document.getElementById('projectCurrentAmount').value = currentAmount;-->

    <!--      // Hiển thị modal-->
    <!--      new bootstrap.Modal(document.getElementById('projectDetailsModal')).show();-->
    <!--    }-->

        function showApprovedProjects() {
        document.getElementById('approvedProjectsTable').style.display = 'table';
        document.getElementById('pendingProjectsTable').style.display = 'none';
        document.getElementById('undisbursedProjectsTable').style.display = 'none';

        document.getElementById('approvedProjectsBtn').classList.add('active-btn');
        document.getElementById('pendingProjectsBtn').classList.remove('active-btn');
        document.getElementById('undisbursedProjectsBtn').classList.remove('active-btn');
    }

    function showPendingProjects() {
        document.getElementById('approvedProjectsTable').style.display = 'none';
        document.getElementById('pendingProjectsTable').style.display = 'table';
        document.getElementById('undisbursedProjectsTable').style.display = 'none';

        document.getElementById('approvedProjectsBtn').classList.remove('active-btn');
        document.getElementById('pendingProjectsBtn').classList.add('active-btn');
        document.getElementById('undisbursedProjectsBtn').classList.remove('active-btn');
    }

    function showUndisbursedProjects() {
        document.getElementById('approvedProjectsTable').style.display = 'none';
        document.getElementById('pendingProjectsTable').style.display = 'none';
        document.getElementById('undisbursedProjectsTable').style.display = 'table';

        document.getElementById('approvedProjectsBtn').classList.remove('active-btn');
        document.getElementById('pendingProjectsBtn').classList.remove('active-btn');
        document.getElementById('undisbursedProjectsBtn').classList.add('active-btn');
    }

    <!--    function filterColumn(columnIndex) {-->
    <!--        const table = document.getElementById("searchTable");-->
    <!--        const input = table.querySelectorAll("thead tr:first-child input")[columnIndex].value.toLowerCase();-->
    <!--        const rows = table.querySelectorAll("tbody tr");-->

    <!--        rows.forEach(row => {-->
    <!--            const cell = row.querySelectorAll("td")[columnIndex];-->
    <!--            if (cell) {-->
    <!--                const text = cell.textContent.toLowerCase();-->
    <!--                if (text.includes(input)) {-->
    <!--                    row.style.display = ""; // Hiển thị hàng-->
    <!--                } else {-->
    <!--                    row.style.display = "none"; // Ẩn hàng-->
    <!--                }-->
    <!--            }-->
    <!--        });-->
    <!--    }-->

         function searchPosts() {
        const searchInput = document.getElementById('searchInput').value;
        alert('Tìm kiếm bài viết với từ khóa: ' + searchInput);
      }


</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
